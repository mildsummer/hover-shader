<!DOCTYPE html>
<html>
<head>
    <title>PixiJS Shaders</title>
    <style type="text/css">
        body {
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
<script type="text/javascript" src="https://cdn.jsdelivr.net/pixi.js/4.3.0/pixi.min.js"></script>
<script id="fShader" type="shader-code">
precision mediump float;
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float     time;
uniform vec2      resolution;

void main(void) {
  vec2 center = vec2(0.5, 0.5);
  float distance = length(center - vTextureCoord);
  float theta = cos(distance * 30.0 - time * 10.0);
  theta *= (1.0 - distance * 1.0) * (1.0 - distance * 1.0);
  theta *= theta;
  theta = theta / 20.0 * (cos(time) + 1.0);
  vec2 v0 = vTextureCoord - center;
  vec2 v1 = vec2(v0.x * cos(theta) - v0.y * sin(theta), v0.x * sin(theta) + v0.y * cos(theta));
  vec2 offset = vec2(v1 + center);
  vec4 pixel = texture2D(uSampler, offset);
  pixel.r += theta;
  pixel.g += theta;
  pixel.b += theta;
  gl_FragColor = pixel;
}
</script>

<script type="text/javascript">
    //Adapted from: http://codepen.io/davidhartley/pen/seEki?editors=0010

    var width = window.innerWidth;
    var height = window.innerHeight;
    var renderer = new PIXI.autoDetectRenderer(width, height);//Chooses either WebGL if supported or falls back to Canvas rendering
    document.body.appendChild(renderer.view);//Add the render view object into the page

    var stage = new PIXI.Container();//The stage is the root container that will hold everything in our scene

    // smoke shader
    var uniforms = {};
    uniforms.time = 0;
    uniforms.resolution = {
        type: 'v2',
        value: {
            x: width,
            y: height
        }
    };
    console.log(width, height);

    var fShaderCode = document.getElementById( 'fShader' ).innerHTML;
    var smokeShader = new PIXI.Filter(null, fShaderCode, uniforms);

    var bg = PIXI.Sprite.fromImage('image.png');
    bg.width = width;
    bg.height = height;
    bg.filters = [smokeShader];
    stage.addChild(bg);

    animate();


    var count = 0;

    function animate() {
        // start the timer for the next animation loop
        requestAnimationFrame(animate);

        count+=0.01;
        smokeShader.uniforms.time = count;

        // this is the main render call that makes pixi draw your container and its children.
        renderer.render(stage);
    }


</script>
</body>
</html>